{% extends "base.html" %}

{% block content %} 
<div class="view-posts">
<table> 
<tr valign="top"> 
    <td><img src="{{ group.avatar }}" alt="Group Avatar"></td>
    <td>
<h1>{{ group.name }}</h1>
<p>{{ group.about }}</p>
<h3>Members</h3>
<span class="label">Members:</span>
{% if group.members and group.members|length > 0 %}
        <ul class="member-list">
        {% for member in group.members %}
        {% if member.user.username == current_user.username %}
            <span>{{ member.user.username }} - you</span>
        {% else %}
            <a href="{{ url_for('user', username=member.user.username) }}">{{ member.user.username }}</a>
        {% endif %}
        {% if not loop.last %}, {% endif %}
    {% endfor %}
        </ul>
    {% else %}
        <span class="no-members">None</span>
    {% endif %}
<a href="{{ url_for('add_members', group_id=group.id) }}" class="btn btn-primary">
    Add Members
</a>
</td>
</table>
<h3>Group Posts</h3>
{% if form %}
<h5>Posting as: {{ current_user.username }}</h5>
<form action="" method="post">
    {{ form.hidden_tag() }}
    <p>
        {{ form.post.label }}<br>
        {{ form.post(cols=32, rows=4) }}<br>
        {% for error in form.post.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </p>
    <p>{{ form.submit() }}</p>
</form>
{% endif %}
    
{% if posts %}
    <ul class="post-list">
        {% for post in posts %}
            {% include '_post.html' %}
        {% endfor %}
    </ul>
    <nav aria-label="Post navigation">
        <ul class="pagination">
            {% if prev_url %}
                <li class="page-item">
                    <a class="page-link" href="{{ prev_url }}">
                        <span aria-hidden="true">&larr;</span> Newer posts
                    </a>
                </li>
            {% endif %}
            {% if next_url %}
                <li class="page-item">
                    <a class="page-link" href="{{ next_url }}">
                        Older posts <span aria-hidden="true">&rarr;</span>
                    </a>
                </li>
            {% endif %}
        </ul>
    </nav>
{% else %}
    <p>No posts in this group yet.</p>
{% endif %}
</div>

{% endblock %} 